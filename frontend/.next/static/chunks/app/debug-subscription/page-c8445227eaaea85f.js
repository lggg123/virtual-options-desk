(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[536],{251:(e,t,a)=>{"use strict";a.d(t,{N:()=>l});var n=a(6911);let s="https://qcwtkyxvejcogbhbauey.supabase.co/",i="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9";s&&i||console.warn("Missing Supabase environment variables");let l=(0,n.createBrowserClient)(s,i)},4322:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>l});var n=a(3365),s=a(1521),i=a(251);function l(){let[e,t]=(0,s.useState)([]),[a,l]=(0,s.useState)(null),[c,o]=(0,s.useState)(!1),r=(0,s.useCallback)(e=>{let a=new Date().toLocaleTimeString();t(t=>[...t,"[".concat(a,"] ").concat(e)]),console.log("[".concat(a,"] ").concat(e))},[]),d=(0,s.useCallback)(async()=>{r("Checking authentication...");try{let{data:{session:e},error:t}=await i.N.auth.getSession();t&&r("Session error: ".concat(t.message)),e||(r("❌ No session found"),r("Trying to get user anyway..."));let{data:{user:a},error:n}=await i.N.auth.getUser();if(n)return void r("Auth error: ".concat(n.message));a?(l(a),r("✅ User authenticated: ".concat(a.email," (ID: ").concat(a.id,")"))):r("❌ No user found - Please login first")}catch(e){r("Exception checking auth: ".concat(e))}},[r]);async function u(){r("Testing environment variables...");let e=i.N;r("Supabase Client: ".concat(e?"✅ Initialized":"❌ Not initialized")),r("Current URL: ".concat(window.location.href)),r("✅ Environment variables are loaded from .env.local")}async function h(){r("Testing payment API health..."),o(!0);try{r("Step 1: Testing Next.js API route...");let e=await fetch("/api/payment/health",{method:"GET"});if(e.ok){let t=await e.json();r("✅ Payment API health: ".concat(JSON.stringify(t)))}else{r("❌ Payment API health check failed: ".concat(e.status));let t=await e.text();r("Error details: ".concat(t))}}catch(e){r("❌ Failed to reach payment API: ".concat(e))}finally{o(!1)}}async function m(){r("Testing checkout endpoint with premium plan..."),o(!0);try{if(!a)return void r("❌ Cannot test checkout: User not authenticated");r("Step 1: Sending POST to /api/payment/checkout...");let e=await fetch("/api/payment/checkout",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({planId:"premium"})});if(r("Response status: ".concat(e.status)),!e.ok){let t=await e.json().catch(()=>({error:"Unknown error"}));r("❌ Checkout failed: ".concat(JSON.stringify(t)));return}let t=await e.json();r("✅ Checkout response: ".concat(JSON.stringify(t,null,2))),t.url?(r("✅ Stripe checkout URL received: ".concat(t.url)),r("Would redirect to Stripe now (not doing it in debug mode)")):r("❌ No URL in response")}catch(e){r("❌ Exception during checkout test: ".concat(e))}finally{o(!1)}}async function g(){r("Testing direct payment API call..."),o(!0);try{if(!a)return void r("❌ Cannot test: User not authenticated");let e="https://lavish-creation-production.up.railway.app/";r("Attempting to reach: ".concat(e,"/health"));let t=await fetch("".concat(e,"/health")),n=await t.json();r("✅ Payment API is reachable: ".concat(JSON.stringify(n)))}catch(e){r("⚠️ Cannot reach payment API directly (expected if deployed): ".concat(e)),r("This is normal if payment API is on a different domain")}finally{o(!1)}}return(0,s.useEffect)(()=>{d();let{data:{subscription:e}}=i.N.auth.onAuthStateChange((e,t)=>{r("Auth state changed: ".concat(e)),(null==t?void 0:t.user)?(l(t.user),r("✅ User updated: ".concat(t.user.email))):(l(null),r("❌ User logged out"))});return()=>{e.unsubscribe()}},[d,r]),(0,n.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 py-12 px-4",children:(0,n.jsx)("div",{className:"max-w-4xl mx-auto",children:(0,n.jsxs)("div",{className:"bg-slate-800 rounded-lg p-8 shadow-xl",children:[(0,n.jsx)("h1",{className:"text-3xl font-bold text-white mb-2",children:"\uD83D\uDD0D Subscription Debug Tool"}),(0,n.jsx)("p",{className:"text-gray-400 mb-6",children:"Use this page to diagnose subscription button issues"}),(0,n.jsxs)("div",{className:"mb-6 p-4 bg-slate-700 rounded-lg",children:[(0,n.jsx)("h2",{className:"text-lg font-semibold text-white mb-2",children:"User Status"}),a?(0,n.jsxs)("div",{className:"text-green-400",children:["✅ Logged in as: ",a.email,(0,n.jsxs)("div",{className:"text-sm text-gray-400 mt-1",children:["User ID: ",a.id]})]}):(0,n.jsxs)("div",{className:"text-red-400",children:["❌ Not logged in - ",(0,n.jsx)("a",{href:"/login",className:"underline",children:"Login first"})]})]}),(0,n.jsxs)("div",{className:"space-y-3 mb-6",children:[(0,n.jsx)("button",{onClick:u,disabled:c,className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700 disabled:opacity-50 font-medium",children:"1. Test Environment Variables"}),(0,n.jsx)("button",{onClick:h,disabled:c,className:"w-full bg-purple-600 text-white py-3 px-4 rounded-lg hover:bg-purple-700 disabled:opacity-50 font-medium",children:"2. Test Payment API Health"}),(0,n.jsx)("button",{onClick:g,disabled:c,className:"w-full bg-indigo-600 text-white py-3 px-4 rounded-lg hover:bg-indigo-700 disabled:opacity-50 font-medium",children:"3. Test Direct Payment API Connection"}),(0,n.jsx)("button",{onClick:m,disabled:c||!a,className:"w-full bg-green-600 text-white py-3 px-4 rounded-lg hover:bg-green-700 disabled:opacity-50 font-medium",children:"4. Test Full Checkout Flow (Premium)"}),(0,n.jsx)("button",{onClick:function(){t([])},className:"w-full bg-slate-600 text-white py-2 px-4 rounded-lg hover:bg-slate-700 font-medium",children:"Clear Logs"})]}),(0,n.jsx)("div",{className:"bg-black rounded-lg p-4 font-mono text-sm max-h-96 overflow-y-auto",children:0===e.length?(0,n.jsx)("div",{className:"text-gray-500",children:"Click a test button above to see logs..."}):e.map((e,t)=>(0,n.jsx)("div",{className:"mb-1 ".concat(e.includes("❌")||e.includes("error")||e.includes("failed")?"text-red-400":e.includes("✅")||e.includes("success")?"text-green-400":e.includes("⚠️")?"text-yellow-400":"text-gray-300"),children:e},t))}),(0,n.jsxs)("div",{className:"mt-6 p-4 bg-slate-700 rounded-lg",children:[(0,n.jsx)("h3",{className:"text-lg font-semibold text-white mb-2",children:"How to Use:"}),(0,n.jsxs)("ol",{className:"text-gray-300 space-y-2 list-decimal list-inside",children:[(0,n.jsx)("li",{children:"Make sure you're logged in"}),(0,n.jsx)("li",{children:"Click each test button in order"}),(0,n.jsx)("li",{children:"Check the logs for any ❌ errors"}),(0,n.jsx)("li",{children:"Copy any error messages and share them if you need help"})]})]}),(0,n.jsx)("div",{className:"mt-4 text-center",children:(0,n.jsx)("a",{href:"/pricing",className:"text-purple-400 hover:text-purple-300 underline",children:"← Back to Pricing Page"})})]})})})}},9223:(e,t,a)=>{Promise.resolve().then(a.bind(a,4322))}},e=>{var t=t=>e(e.s=t);e.O(0,[6911,2347,4870,7358],()=>t(9223)),_N_E=e.O()}]);