(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[536],{1948:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>c});var n=a(5800),s=a(5924),i=a(5161),l=a(298);function c(){let[e,t]=(0,s.useState)([]),[a,c]=(0,s.useState)(null),[o,r]=(0,s.useState)(!1),d=(0,s.useCallback)(e=>{let a=new Date().toLocaleTimeString();t(t=>[...t,"[".concat(a,"] ").concat(e)]),console.log("[".concat(a,"] ").concat(e))},[]),u=(0,s.useCallback)(async()=>{d("Checking authentication...");try{let{data:{session:e},error:t}=await i.N.auth.getSession();t&&d("Session error: ".concat(t.message)),e||(d("❌ No session found"),d("Trying to get user anyway..."));let{data:{user:a},error:n}=await i.N.auth.getUser();if(n)return void d("Auth error: ".concat(n.message));a?(c(a),d("✅ User authenticated: ".concat(a.email," (ID: ").concat(a.id,")"))):d("❌ No user found - Please login first")}catch(e){d("Exception checking auth: ".concat(e))}},[d]);async function h(){d("Testing environment variables...");let e=i.N;d("Supabase Client: ".concat(e?"✅ Initialized":"❌ Not initialized")),d("Current URL: ".concat(window.location.href)),d("✅ Environment variables are loaded from .env.local")}async function m(){d("Testing payment API health..."),r(!0);try{d("Step 1: Testing Next.js API route...");let e=await fetch("/api/payment/health",{method:"GET"});if(e.ok){let t=await e.json();d("✅ Payment API health: ".concat(JSON.stringify(t)))}else{d("❌ Payment API health check failed: ".concat(e.status));let t=await e.text();d("Error details: ".concat(t))}}catch(e){d("❌ Failed to reach payment API: ".concat(e))}finally{r(!1)}}async function g(){d("Testing checkout endpoint with premium plan..."),r(!0);try{if(!a)return void d("❌ Cannot test checkout: User not authenticated");d("Step 1: Sending POST to /api/payment/checkout...");let e=await fetch("/api/payment/checkout",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({planId:"premium"})});if(d("Response status: ".concat(e.status)),!e.ok){let t=await e.json().catch(()=>({error:"Unknown error"}));d("❌ Checkout failed: ".concat(JSON.stringify(t)));return}let t=await e.json();d("✅ Checkout response: ".concat(JSON.stringify(t,null,2))),t.url?(d("✅ Stripe checkout URL received: ".concat(t.url)),d("Would redirect to Stripe now (not doing it in debug mode)")):d("❌ No URL in response")}catch(e){d("❌ Exception during checkout test: ".concat(e))}finally{r(!1)}}async function p(){d("Testing direct payment API call..."),r(!0);try{if(!a)return void d("❌ Cannot test: User not authenticated");let e=l.env.NEXT_PUBLIC_PAYMENT_API_URL||"http://localhost:3001";d("Attempting to reach: ".concat(e,"/health"));let t=await fetch("".concat(e,"/health")),n=await t.json();d("✅ Payment API is reachable: ".concat(JSON.stringify(n)))}catch(e){d("⚠️ Cannot reach payment API directly (expected if deployed): ".concat(e)),d("This is normal if payment API is on a different domain")}finally{r(!1)}}return(0,s.useEffect)(()=>{u();let{data:{subscription:e}}=i.N.auth.onAuthStateChange((e,t)=>{d("Auth state changed: ".concat(e)),(null==t?void 0:t.user)?(c(t.user),d("✅ User updated: ".concat(t.user.email))):(c(null),d("❌ User logged out"))});return()=>{e.unsubscribe()}},[u,d]),(0,n.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 py-12 px-4",children:(0,n.jsx)("div",{className:"max-w-4xl mx-auto",children:(0,n.jsxs)("div",{className:"bg-slate-800 rounded-lg p-8 shadow-xl",children:[(0,n.jsx)("h1",{className:"text-3xl font-bold text-white mb-2",children:"\uD83D\uDD0D Subscription Debug Tool"}),(0,n.jsx)("p",{className:"text-gray-400 mb-6",children:"Use this page to diagnose subscription button issues"}),(0,n.jsxs)("div",{className:"mb-6 p-4 bg-slate-700 rounded-lg",children:[(0,n.jsx)("h2",{className:"text-lg font-semibold text-white mb-2",children:"User Status"}),a?(0,n.jsxs)("div",{className:"text-green-400",children:["✅ Logged in as: ",a.email,(0,n.jsxs)("div",{className:"text-sm text-gray-400 mt-1",children:["User ID: ",a.id]})]}):(0,n.jsxs)("div",{className:"text-red-400",children:["❌ Not logged in - ",(0,n.jsx)("a",{href:"/login",className:"underline",children:"Login first"})]})]}),(0,n.jsxs)("div",{className:"space-y-3 mb-6",children:[(0,n.jsx)("button",{onClick:h,disabled:o,className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700 disabled:opacity-50 font-medium",children:"1. Test Environment Variables"}),(0,n.jsx)("button",{onClick:m,disabled:o,className:"w-full bg-purple-600 text-white py-3 px-4 rounded-lg hover:bg-purple-700 disabled:opacity-50 font-medium",children:"2. Test Payment API Health"}),(0,n.jsx)("button",{onClick:p,disabled:o,className:"w-full bg-indigo-600 text-white py-3 px-4 rounded-lg hover:bg-indigo-700 disabled:opacity-50 font-medium",children:"3. Test Direct Payment API Connection"}),(0,n.jsx)("button",{onClick:g,disabled:o||!a,className:"w-full bg-green-600 text-white py-3 px-4 rounded-lg hover:bg-green-700 disabled:opacity-50 font-medium",children:"4. Test Full Checkout Flow (Premium)"}),(0,n.jsx)("button",{onClick:function(){t([])},className:"w-full bg-slate-600 text-white py-2 px-4 rounded-lg hover:bg-slate-700 font-medium",children:"Clear Logs"})]}),(0,n.jsx)("div",{className:"bg-black rounded-lg p-4 font-mono text-sm max-h-96 overflow-y-auto",children:0===e.length?(0,n.jsx)("div",{className:"text-gray-500",children:"Click a test button above to see logs..."}):e.map((e,t)=>(0,n.jsx)("div",{className:"mb-1 ".concat(e.includes("❌")||e.includes("error")||e.includes("failed")?"text-red-400":e.includes("✅")||e.includes("success")?"text-green-400":e.includes("⚠️")?"text-yellow-400":"text-gray-300"),children:e},t))}),(0,n.jsxs)("div",{className:"mt-6 p-4 bg-slate-700 rounded-lg",children:[(0,n.jsx)("h3",{className:"text-lg font-semibold text-white mb-2",children:"How to Use:"}),(0,n.jsxs)("ol",{className:"text-gray-300 space-y-2 list-decimal list-inside",children:[(0,n.jsx)("li",{children:"Make sure you're logged in"}),(0,n.jsx)("li",{children:"Click each test button in order"}),(0,n.jsx)("li",{children:"Check the logs for any ❌ errors"}),(0,n.jsx)("li",{children:"Copy any error messages and share them if you need help"})]})]}),(0,n.jsx)("div",{className:"mt-4 text-center",children:(0,n.jsx)("a",{href:"/pricing",className:"text-purple-400 hover:text-purple-300 underline",children:"← Back to Pricing Page"})})]})})})}},5161:(e,t,a)=>{"use strict";a.d(t,{N:()=>c});var n=a(3899),s=a(298);let i=s.env.NEXT_PUBLIC_SUPABASE_URL||"",l=s.env.NEXT_PUBLIC_SUPABASE_ANON_KEY||"";i&&l||console.warn("Missing Supabase environment variables");let c=(0,n.createBrowserClient)(i,l)},9742:(e,t,a)=>{Promise.resolve().then(a.bind(a,1948))}},e=>{var t=t=>e(e.s=t);e.O(0,[3899,7116,9683,7358],()=>t(9742)),_N_E=e.O()}]);