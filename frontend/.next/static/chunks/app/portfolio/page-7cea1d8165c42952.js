(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5281],{553:(e,t,s)=>{"use strict";s.d(t,{default:()=>c});var r=s(3365),a=s(1521),n=s(8159),i=s(9672),l=s(3678),o=s(1401);function c(){let[e,t]=(0,a.useState)([]),[s,c]=(0,a.useState)(!0),[d,u]=(0,a.useState)(0);async function x(){try{let e=await fetch("/api/positions");if(e.ok){let s=await e.json();t(s.positions||[]);let r=(s.positions||[]).reduce((e,t)=>e+t.currentPrice*t.quantity*100,0);u(r)}}catch(e){console.error("Error fetching positions:",e)}finally{c(!1)}}if((0,a.useEffect)(()=>{x()},[]),s)return(0,r.jsx)(n.Zp,{children:(0,r.jsx)(n.aR,{children:(0,r.jsxs)(n.ZB,{className:"flex items-center gap-2",children:[(0,r.jsx)(l.A,{className:"h-5 w-5 animate-spin"}),"Loading Portfolio..."]})})});if(0===e.length)return(0,r.jsxs)(n.Zp,{children:[(0,r.jsxs)(n.aR,{children:[(0,r.jsx)(n.ZB,{children:"Portfolio Positions"}),(0,r.jsx)(n.BT,{children:"Current options positions breakdown"})]}),(0,r.jsx)(n.Wu,{children:(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[(0,r.jsx)(o.A,{className:"h-12 w-12 text-muted-foreground mb-4"}),(0,r.jsx)("h3",{className:"text-lg font-medium mb-2",children:"No positions yet"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground max-w-sm",children:"Start trading to build your portfolio. You have $2,000,000 in virtual cash to get started."})]})})]});let m=e.reduce((e,t)=>{let s=e.find(e=>e.symbol===t.symbol&&e.type===t.type),r=t.currentPrice*t.quantity*100;return s?(s.quantity+=t.quantity,s.value+=r):e.push({symbol:t.symbol,type:t.type,quantity:t.quantity,value:r,percentage:0}),e},[]);return m.forEach(e=>{e.percentage=d>0?e.value/d*100:0}),(0,r.jsxs)(n.Zp,{children:[(0,r.jsxs)(n.aR,{children:[(0,r.jsx)(n.ZB,{children:"Portfolio Positions"}),(0,r.jsx)(n.BT,{children:"Current options positions breakdown"})]}),(0,r.jsx)(n.Wu,{children:(0,r.jsx)("div",{className:"space-y-6",children:m.map(e=>(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"font-medium",children:[e.symbol," ",e.type]}),(0,r.jsxs)("div",{className:"text-sm text-muted-foreground",children:[e.quantity," contracts"]})]}),(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsxs)("div",{className:"font-medium",children:["$",e.value.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]}),(0,r.jsxs)("div",{className:"text-sm text-muted-foreground",children:[e.percentage.toFixed(1),"%"]})]})]}),(0,r.jsx)(i.k,{value:e.percentage,className:"h-2"})]},"".concat(e.symbol,"-").concat(e.type)))})})]})}},1951:(e,t,s)=>{"use strict";s.d(t,{A0:()=>i,BF:()=>l,Hj:()=>o,XI:()=>n,nA:()=>d,nd:()=>c});var r=s(3365);s(1521);var a=s(4130);function n(e){let{className:t,...s}=e;return(0,r.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:(0,r.jsx)("table",{"data-slot":"table",className:(0,a.cn)("w-full caption-bottom text-sm",t),...s})})}function i(e){let{className:t,...s}=e;return(0,r.jsx)("thead",{"data-slot":"table-header",className:(0,a.cn)("[&_tr]:border-b",t),...s})}function l(e){let{className:t,...s}=e;return(0,r.jsx)("tbody",{"data-slot":"table-body",className:(0,a.cn)("[&_tr:last-child]:border-0",t),...s})}function o(e){let{className:t,...s}=e;return(0,r.jsx)("tr",{"data-slot":"table-row",className:(0,a.cn)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",t),...s})}function c(e){let{className:t,...s}=e;return(0,r.jsx)("th",{"data-slot":"table-head",className:(0,a.cn)("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...s})}function d(e){let{className:t,...s}=e;return(0,r.jsx)("td",{"data-slot":"table-cell",className:(0,a.cn)("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...s})}},2196:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(7982).A)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},2406:(e,t,s)=>{Promise.resolve().then(s.bind(s,7615))},3414:(e,t,s)=>{"use strict";s.d(t,{E:()=>o});var r=s(3365);s(1521);var a=s(544),n=s(2934),i=s(4130);let l=(0,n.F)("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function o(e){let{className:t,variant:s,asChild:n=!1,...o}=e,c=n?a.DX:"span";return(0,r.jsx)(c,{"data-slot":"badge",className:(0,i.cn)(l({variant:s}),t),...o})}},3678:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(7982).A)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},3760:(e,t,s)=>{"use strict";s.d(t,{default:()=>o});var r=s(3365),a=s(1521),n=s(8159),i=s(3414),l=s(3678);function o(){let[e,t]=(0,a.useState)([]),[s,o]=(0,a.useState)(!0),[c,d]=(0,a.useState)(null);(0,a.useEffect)(()=>{(async()=>{try{o(!0);let e=await fetch("/api/trades");if(!e.ok)throw Error("Failed to fetch trades");let s=await e.json();s.success?t(s.data||[]):d(s.error||"Failed to load trades")}catch(e){console.error("Error fetching trades:",e),d("Failed to load recent trades")}finally{o(!1)}})()},[]);let u=e=>new Date(e).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}),x=e=>new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric"});return(0,r.jsxs)(n.Zp,{children:[(0,r.jsxs)(n.aR,{children:[(0,r.jsx)(n.ZB,{children:"Recent Trades"}),(0,r.jsx)(n.BT,{children:"Your latest options transactions"})]}),(0,r.jsx)(n.Wu,{children:s?(0,r.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,r.jsx)(l.A,{className:"h-6 w-6 animate-spin text-muted-foreground"}),(0,r.jsx)("span",{className:"ml-2 text-muted-foreground",children:"Loading trades..."})]}):c?(0,r.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:(0,r.jsx)("p",{children:c})}):0===e.length?(0,r.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:(0,r.jsx)("p",{children:"No trades yet. Start trading to see your history here!"})}):(0,r.jsx)("div",{className:"space-y-4",children:e.map(e=>(0,r.jsxs)("div",{className:"flex items-center justify-between border-b pb-2 last:border-0",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"font-medium",children:[e.symbol," $",e.strike_price,"call"===e.option_type?"C":"P"," ",x(e.expiry_date)]}),(0,r.jsxs)("div",{className:"text-sm text-muted-foreground",children:[e.quantity," contracts @ $",e.premium.toFixed(2)]}),(0,r.jsxs)("div",{className:"text-xs text-muted-foreground",children:["Total: $",(e.premium*e.quantity*100).toFixed(2)]})]}),(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsx)(i.E,{variant:"buy"===e.action?"default":"secondary",children:e.action.toUpperCase()}),(0,r.jsx)("div",{className:"text-sm text-muted-foreground mt-1",children:u(e.created_at)})]})]},e.id))})})]})}},4209:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(7982).A)("rotate-ccw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]])},7615:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>u});var r=s(3365),a=s(1521),n=s(8159),i=s(9205),l=s(553),o=s(9366),c=s(3760),d=s(251);function u(){var e,t,s;let[u,x]=(0,a.useState)(null),[m,h]=(0,a.useState)(!0);(0,a.useEffect)(()=>{(async()=>{try{let{data:{user:e},error:t}=await d.N.auth.getUser();if(t||!e){console.error("Error fetching user:",t),h(!1);return}let{data:s,error:r}=await d.N.from("profiles").select("*").eq("id",e.id).single();r?console.log("No profile found, using defaults:",r):console.log("Profile loaded:",s),x({id:e.id,email:e.email,portfolio_value:2e6,open_positions:0,total_return:0})}catch(e){console.error("Exception fetching profile:",e),h(!1)}finally{h(!1)}})()},[]);let f=null!=(e=null==u?void 0:u.portfolio_value)?e:2e6,p=null!=(t=null==u?void 0:u.open_positions)?t:0,v=null!=(s=null==u?void 0:u.total_return)?s:0;return(0,r.jsxs)("div",{className:"min-h-screen bg-background",children:[(0,r.jsx)(i.default,{}),(0,r.jsxs)("main",{className:"container mx-auto px-4 py-6 space-y-6",children:[(0,r.jsxs)(n.Zp,{children:[(0,r.jsxs)(n.aR,{children:[(0,r.jsx)(n.ZB,{className:"text-3xl font-bold",children:"Portfolio"}),(0,r.jsxs)(n.BT,{children:["Track your positions and performance across all your options trades",(null==u?void 0:u.email)&&" - ".concat(u.email)]})]}),(0,r.jsx)(n.Wu,{children:m?(0,r.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:"Loading portfolio data..."}):(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[(0,r.jsxs)("div",{className:"text-center p-4 bg-muted rounded-lg",children:[(0,r.jsxs)("div",{className:"text-2xl font-bold text-green-600",children:["$",f.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]}),(0,r.jsx)("div",{className:"text-sm text-muted-foreground",children:"Total Value"})]}),(0,r.jsxs)("div",{className:"text-center p-4 bg-muted rounded-lg",children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:p}),(0,r.jsx)("div",{className:"text-sm text-muted-foreground",children:"Open Positions"})]}),(0,r.jsxs)("div",{className:"text-center p-4 bg-muted rounded-lg",children:[(0,r.jsxs)("div",{className:"text-2xl font-bold ".concat(v>=0?"text-orange-600":"text-red-600"),children:[v>=0?"+":"",v.toFixed(1),"%"]}),(0,r.jsx)("div",{className:"text-sm text-muted-foreground",children:"Total Return"})]})]})})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,r.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,r.jsx)(l.default,{}),(0,r.jsx)(o.A,{})]}),(0,r.jsx)("div",{children:(0,r.jsx)(c.default,{})})]})]})]})}},8159:(e,t,s)=>{"use strict";s.d(t,{BT:()=>o,Wu:()=>c,ZB:()=>l,Zp:()=>n,aR:()=>i});var r=s(3365);s(1521);var a=s(4130);function n(e){let{className:t,...s}=e;return(0,r.jsx)("div",{"data-slot":"card",className:(0,a.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",t),...s})}function i(e){let{className:t,...s}=e;return(0,r.jsx)("div",{"data-slot":"card-header",className:(0,a.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",t),...s})}function l(e){let{className:t,...s}=e;return(0,r.jsx)("div",{"data-slot":"card-title",className:(0,a.cn)("leading-none font-semibold",t),...s})}function o(e){let{className:t,...s}=e;return(0,r.jsx)("div",{"data-slot":"card-description",className:(0,a.cn)("text-muted-foreground text-sm",t),...s})}function c(e){let{className:t,...s}=e;return(0,r.jsx)("div",{"data-slot":"card-content",className:(0,a.cn)("px-6",t),...s})}},8475:(e,t,s)=>{"use strict";s.d(t,{C1:()=>b,bL:()=>y});var r=s(1521),a=s(7197),n=s(7067),i=s(3365),l="Progress",[o,c]=(0,a.A)(l),[d,u]=o(l),x=r.forwardRef((e,t)=>{var s,r,a,l;let{__scopeProgress:o,value:c=null,max:u,getValueLabel:x=f,...m}=e;(u||0===u)&&!j(u)&&console.error((s="".concat(u),r="Progress","Invalid prop `max` of value `".concat(s,"` supplied to `").concat(r,"`. Only numbers greater than 0 are valid max values. Defaulting to `").concat(100,"`.")));let h=j(u)?u:100;null===c||g(c,h)||console.error((a="".concat(c),l="Progress","Invalid prop `value` of value `".concat(a,"` supplied to `").concat(l,"`. The `value` prop must be:\n  - a positive number\n  - less than the value passed to `max` (or ").concat(100," if no `max` prop is set)\n  - `null` or `undefined` if the progress is indeterminate.\n\nDefaulting to `null`.")));let y=g(c,h)?c:null,b=v(y)?x(y,h):void 0;return(0,i.jsx)(d,{scope:o,value:y,max:h,children:(0,i.jsx)(n.sG.div,{"aria-valuemax":h,"aria-valuemin":0,"aria-valuenow":v(y)?y:void 0,"aria-valuetext":b,role:"progressbar","data-state":p(y,h),"data-value":null!=y?y:void 0,"data-max":h,...m,ref:t})})});x.displayName=l;var m="ProgressIndicator",h=r.forwardRef((e,t)=>{var s;let{__scopeProgress:r,...a}=e,l=u(m,r);return(0,i.jsx)(n.sG.div,{"data-state":p(l.value,l.max),"data-value":null!=(s=l.value)?s:void 0,"data-max":l.max,...a,ref:t})});function f(e,t){return"".concat(Math.round(e/t*100),"%")}function p(e,t){return null==e?"indeterminate":e===t?"complete":"loading"}function v(e){return"number"==typeof e}function j(e){return v(e)&&!isNaN(e)&&e>0}function g(e,t){return v(e)&&!isNaN(e)&&e<=t&&e>=0}h.displayName=m;var y=x,b=h},9366:(e,t,s)=>{"use strict";s.d(t,{A:()=>m});var r=s(3365),a=s(1521),n=s(8159),i=s(8005),l=s(3414),o=s(1951),c=s(3678),d=s(4209),u=s(2196),x=s(1971);function m(){let[e,t]=(0,a.useState)([]),[s,m]=(0,a.useState)(!0),[h,f]=(0,a.useState)(!1),p=(0,a.useCallback)(async()=>{try{let e=await fetch("/api/positions"),s=await e.json();if(!e.ok)throw Error(s.error||"Failed to fetch positions");t(s.positions||[])}catch(e){console.error("Error fetching positions:",e),x.o.error("Failed to fetch positions"),t([])}finally{m(!1),f(!1)}},[]),v=(0,a.useCallback)(async()=>{f(!0),await p()},[p]);(0,a.useEffect)(()=>{p();let e=()=>{v()};return window.addEventListener("orderPlaced",e),()=>window.removeEventListener("orderPlaced",e)},[p,v]);let j=async e=>{try{if(!(await fetch("/api/positions/".concat(e),{method:"DELETE"})).ok)throw Error("Failed to close position");await v(),x.o.success("Position closed successfully")}catch(e){console.error("Error closing position:",e),x.o.error("Failed to close position")}},g=()=>{x.o.info("Roll position functionality coming soon")},y=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e),b=e=>"".concat(e>0?"+":"").concat(e.toFixed(2),"%");return s?(0,r.jsx)(n.Zp,{children:(0,r.jsx)(n.aR,{children:(0,r.jsxs)(n.ZB,{className:"flex items-center gap-2",children:[(0,r.jsx)(c.A,{className:"h-5 w-5 animate-spin"}),"Loading Positions..."]})})}):(0,r.jsxs)(n.Zp,{children:[(0,r.jsx)(n.aR,{children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(n.ZB,{children:"Active Positions"}),(0,r.jsxs)(n.BT,{children:[e.length," active option",1!==e.length?"s":""]})]}),(0,r.jsxs)(i.$,{variant:"outline",size:"sm",onClick:v,disabled:h,children:[h?(0,r.jsx)(c.A,{className:"h-4 w-4 animate-spin"}):(0,r.jsx)(d.A,{className:"h-4 w-4"}),"Refresh"]})]})}),(0,r.jsx)(n.Wu,{children:0===e.length?(0,r.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,r.jsx)("p",{children:"No active positions"}),(0,r.jsx)("p",{className:"text-sm",children:"Place your first trade to see positions here"})]}):(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)(o.XI,{children:[(0,r.jsx)(o.A0,{children:(0,r.jsxs)(o.Hj,{children:[(0,r.jsx)(o.nd,{children:"Contract"}),(0,r.jsx)(o.nd,{children:"Qty"}),(0,r.jsx)(o.nd,{children:"Avg Price"}),(0,r.jsx)(o.nd,{children:"Current"}),(0,r.jsx)(o.nd,{children:"P&L"}),(0,r.jsx)(o.nd,{children:"Greeks"}),(0,r.jsx)(o.nd,{children:"Actions"})]})}),(0,r.jsx)(o.BF,{children:e.map(e=>(0,r.jsxs)(o.Hj,{children:[(0,r.jsx)(o.nA,{children:(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("div",{className:"font-medium",children:e.symbol}),(0,r.jsxs)("div",{className:"text-sm text-muted-foreground",children:[e.expiry," $",e.strike,e.type.charAt(0)]})]})}),(0,r.jsx)(o.nA,{children:(0,r.jsx)(l.E,{variant:e.quantity>0?"default":"destructive",children:e.quantity>0?"+".concat(e.quantity):e.quantity})}),(0,r.jsx)(o.nA,{children:y(e.avgPrice)}),(0,r.jsx)(o.nA,{children:y(e.currentPrice)}),(0,r.jsx)(o.nA,{children:(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("div",{className:"font-medium ".concat(e.pnl>=0?"text-green-600":"text-red-600"),children:y(e.pnl)}),(0,r.jsx)("div",{className:"text-sm ".concat(e.pnlPercent>=0?"text-green-600":"text-red-600"),children:b(e.pnlPercent)})]})}),(0,r.jsx)(o.nA,{children:(0,r.jsxs)("div",{className:"space-y-1 text-sm",children:[(0,r.jsxs)("div",{children:["Δ ",e.delta.toFixed(3)]}),(0,r.jsxs)("div",{children:["Θ ",e.theta.toFixed(3)]}),(0,r.jsxs)("div",{children:["Γ ",e.gamma.toFixed(3)]}),(0,r.jsxs)("div",{children:["ν ",e.vega.toFixed(2)]})]})}),(0,r.jsx)(o.nA,{children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)(i.$,{variant:"outline",size:"sm",onClick:()=>g(),children:[(0,r.jsx)(d.A,{className:"h-3 w-3"}),"Roll"]}),(0,r.jsxs)(i.$,{variant:"outline",size:"sm",onClick:()=>j(e.id),children:[(0,r.jsx)(u.A,{className:"h-3 w-3"}),"Close"]})]})})]},e.id))})]})})})]})}},9672:(e,t,s)=>{"use strict";s.d(t,{k:()=>i});var r=s(3365);s(1521);var a=s(8475),n=s(4130);function i(e){let{className:t,value:s,...i}=e;return(0,r.jsx)(a.bL,{"data-slot":"progress",className:(0,n.cn)("bg-primary/20 relative h-2 w-full overflow-hidden rounded-full",t),...i,children:(0,r.jsx)(a.C1,{"data-slot":"progress-indicator",className:"bg-primary h-full w-full flex-1 transition-all",style:{transform:"translateX(-".concat(100-(s||0),"%)")}})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[6911,6301,798,4778,1971,9205,2347,4870,7358],()=>t(2406)),_N_E=e.O()}]);