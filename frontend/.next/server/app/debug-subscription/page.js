(()=>{var e={};e.id=536,e.ids=[536],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},7066:(e,t,s)=>{Promise.resolve().then(s.bind(s,20330))},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11997:e=>{"use strict";e.exports=require("punycode")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},20330:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});let r=(0,s(34948).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/workspaces/virtual-options-desk/frontend/src/app/debug-subscription/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/workspaces/virtual-options-desk/frontend/src/app/debug-subscription/page.tsx","default")},27910:e=>{"use strict";e.exports=require("stream")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},34631:e=>{"use strict";e.exports=require("tls")},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},59249:e=>{"use strict";e.exports=require("http")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},74075:e=>{"use strict";e.exports=require("zlib")},75522:(e,t,s)=>{Promise.resolve().then(s.bind(s,79616))},79428:e=>{"use strict";e.exports=require("buffer")},79551:e=>{"use strict";e.exports=require("url")},79616:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var r=s(99586),i=s(39547),n=s(8755);function a(){let[e,t]=(0,i.useState)([]),[s,a]=(0,i.useState)(null),[o,l]=(0,i.useState)(!1),d=(0,i.useCallback)(e=>{let s=new Date().toLocaleTimeString();t(t=>[...t,`[${s}] ${e}`]),console.log(`[${s}] ${e}`)},[]);async function c(){d("Testing environment variables..."),d(`Supabase Client: ❌ Not initialized`),d("Current URL: N/A"),d("✅ Environment variables are loaded from .env.local")}async function u(){d("Testing payment API health..."),l(!0);try{d("Step 1: Testing Next.js API route...");let e=await fetch("/api/payment/health",{method:"GET"});if(e.ok){let t=await e.json();d(`✅ Payment API health: ${JSON.stringify(t)}`)}else{d(`❌ Payment API health check failed: ${e.status}`);let t=await e.text();d(`Error details: ${t}`)}}catch(e){d(`❌ Failed to reach payment API: ${e}`)}finally{l(!1)}}async function p(){d("Testing checkout endpoint with premium plan..."),l(!0);try{if(!s)return void d("❌ Cannot test checkout: User not authenticated");d("Step 1: Sending POST to /api/payment/checkout...");let e=await fetch("/api/payment/checkout",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({planId:"premium"})});if(d(`Response status: ${e.status}`),!e.ok){let t=await e.json().catch(()=>({error:"Unknown error"}));d(`❌ Checkout failed: ${JSON.stringify(t)}`);return}let t=await e.json();d(`✅ Checkout response: ${JSON.stringify(t,null,2)}`),t.url?(d(`✅ Stripe checkout URL received: ${t.url}`),d("Would redirect to Stripe now (not doing it in debug mode)")):d("❌ No URL in response")}catch(e){d(`❌ Exception during checkout test: ${e}`)}finally{l(!1)}}async function h(){d("Testing direct payment API call..."),l(!0);try{if(!s)return void d("❌ Cannot test: User not authenticated");let e=process.env.NEXT_PUBLIC_PAYMENT_API_URL||"http://localhost:3001";d(`Attempting to reach: ${e}/health`);let t=await fetch(`${e}/health`),r=await t.json();d(`✅ Payment API is reachable: ${JSON.stringify(r)}`)}catch(e){d(`⚠️ Cannot reach payment API directly (expected if deployed): ${e}`),d("This is normal if payment API is on a different domain")}finally{l(!1)}}return(0,i.useCallback)(async()=>{d("Checking authentication...");try{let{data:{session:e},error:t}=await n.N.auth.getSession();t&&d(`Session error: ${t.message}`),e||(d("❌ No session found"),d("Trying to get user anyway..."));let{data:{user:s},error:r}=await n.N.auth.getUser();if(r)return void d(`Auth error: ${r.message}`);s?(a(s),d(`✅ User authenticated: ${s.email} (ID: ${s.id})`)):d("❌ No user found - Please login first")}catch(e){d(`Exception checking auth: ${e}`)}},[d]),(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 py-12 px-4",children:(0,r.jsx)("div",{className:"max-w-4xl mx-auto",children:(0,r.jsxs)("div",{className:"bg-slate-800 rounded-lg p-8 shadow-xl",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-white mb-2",children:"\uD83D\uDD0D Subscription Debug Tool"}),(0,r.jsx)("p",{className:"text-gray-400 mb-6",children:"Use this page to diagnose subscription button issues"}),(0,r.jsxs)("div",{className:"mb-6 p-4 bg-slate-700 rounded-lg",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold text-white mb-2",children:"User Status"}),s?(0,r.jsxs)("div",{className:"text-green-400",children:["✅ Logged in as: ",s.email,(0,r.jsxs)("div",{className:"text-sm text-gray-400 mt-1",children:["User ID: ",s.id]})]}):(0,r.jsxs)("div",{className:"text-red-400",children:["❌ Not logged in - ",(0,r.jsx)("a",{href:"/login",className:"underline",children:"Login first"})]})]}),(0,r.jsxs)("div",{className:"space-y-3 mb-6",children:[(0,r.jsx)("button",{onClick:c,disabled:o,className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700 disabled:opacity-50 font-medium",children:"1. Test Environment Variables"}),(0,r.jsx)("button",{onClick:u,disabled:o,className:"w-full bg-purple-600 text-white py-3 px-4 rounded-lg hover:bg-purple-700 disabled:opacity-50 font-medium",children:"2. Test Payment API Health"}),(0,r.jsx)("button",{onClick:h,disabled:o,className:"w-full bg-indigo-600 text-white py-3 px-4 rounded-lg hover:bg-indigo-700 disabled:opacity-50 font-medium",children:"3. Test Direct Payment API Connection"}),(0,r.jsx)("button",{onClick:p,disabled:o||!s,className:"w-full bg-green-600 text-white py-3 px-4 rounded-lg hover:bg-green-700 disabled:opacity-50 font-medium",children:"4. Test Full Checkout Flow (Premium)"}),(0,r.jsx)("button",{onClick:function(){t([])},className:"w-full bg-slate-600 text-white py-2 px-4 rounded-lg hover:bg-slate-700 font-medium",children:"Clear Logs"})]}),(0,r.jsx)("div",{className:"bg-black rounded-lg p-4 font-mono text-sm max-h-96 overflow-y-auto",children:0===e.length?(0,r.jsx)("div",{className:"text-gray-500",children:"Click a test button above to see logs..."}):e.map((e,t)=>(0,r.jsx)("div",{className:`mb-1 ${e.includes("❌")||e.includes("error")||e.includes("failed")?"text-red-400":e.includes("✅")||e.includes("success")?"text-green-400":e.includes("⚠️")?"text-yellow-400":"text-gray-300"}`,children:e},t))}),(0,r.jsxs)("div",{className:"mt-6 p-4 bg-slate-700 rounded-lg",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-white mb-2",children:"How to Use:"}),(0,r.jsxs)("ol",{className:"text-gray-300 space-y-2 list-decimal list-inside",children:[(0,r.jsx)("li",{children:"Make sure you're logged in"}),(0,r.jsx)("li",{children:"Click each test button in order"}),(0,r.jsx)("li",{children:"Check the logs for any ❌ errors"}),(0,r.jsx)("li",{children:"Copy any error messages and share them if you need help"})]})]}),(0,r.jsx)("div",{className:"mt-4 text-center",children:(0,r.jsx)("a",{href:"/pricing",className:"text-purple-400 hover:text-purple-300 underline",children:"← Back to Pricing Page"})})]})})})}},86579:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var r=s(4011);let i=async e=>[{type:"image/x-icon",sizes:"16x16",url:(0,r.fillMetadataSegment)(".",await e.params,"favicon.ico")+""}]},91645:e=>{"use strict";e.exports=require("net")},94022:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>a.a,__next_app__:()=>u,pages:()=>c,routeModule:()=>p,tree:()=>d});var r=s(87528),i=s(35095),n=s(40591),a=s.n(n),o=s(66080),l={};for(let e in o)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);s.d(t,l);let d={children:["",{children:["debug-subscription",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,20330)),"/workspaces/virtual-options-desk/frontend/src/app/debug-subscription/page.tsx"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,86579))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(s.bind(s,27225)),"/workspaces/virtual-options-desk/frontend/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,71677,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(s.t.bind(s,54144,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(s.t.bind(s,27249,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,86579))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,c=["/workspaces/virtual-options-desk/frontend/src/app/debug-subscription/page.tsx"],u={require:s,loadChunk:()=>Promise.resolve()},p=new r.AppPageRouteModule({definition:{kind:i.RouteKind.APP_PAGE,page:"/debug-subscription/page",pathname:"/debug-subscription",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},94735:e=>{"use strict";e.exports=require("events")}};var t=require("../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[5143,8327,9249,6328],()=>s(94022));module.exports=r})();